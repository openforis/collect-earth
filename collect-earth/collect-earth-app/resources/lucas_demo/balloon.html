<!DOCTYPE html>
<html>
<head>
<title>LUCAS Land Use survey</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="earthFiles/jquery/jquery.js?random=$[randomNumber]"></script>
<script src="earthFiles/jquery/jquery-ui.js?random=$[randomNumber]"></script>
<script src="earthFiles/jquery/jquery.blockUI.js?random=$[randomNumber]"></script>
<script src="earthFiles/bootstrap/bootstrap.min.js?random=$[randomNumber]"></script>
<script src="earthFiles/bootstrap/bootstrap-select.js?random=$[randomNumber]"></script>

<link href="earthFiles/jquery/jquery-ui.css?random=$[randomNumber]" rel="stylesheet" />
<link href="earthFiles/bootstrap/bootstrap.css?random=$[randomNumber]" rel="stylesheet" />
<link href="earthFiles/bootstrap/bootstrap-select.css?random=$[randomNumber]" rel="stylesheet" />
<script>
	var SEPARATOR_MULTIPLE_PARAMETERS = "===";
	var SEPARATOR_MULTIPLE_VALUES = ";";
	
	var fillYears = function() {

		for (year = new Date().getFullYear(); year > 1980; year--) {
			$('.fillYears').each(
					function () {   
						$(this).append( $("<option></option>").attr("value", year).text( year) );
					}
			);
		}
		
	};

	var addChangeOther = function( selectObject, otherCommentTextField ){
	
		selectObject.change(
				function(){
					
					var selectedItems = selectObject.find('option:selected');
					var foundOther = false;
					selectedItems.each(
							function(){
								if( $(this).val() == otherCommentTextField ){
									foundOther = true;
								}
							}
					);
					
					if( foundOther ){
						selectObject.closest('div').find(".visible_other").show();
					}else{
						selectObject.closest('div').find(".visible_other").hide();
						selectObject.closest('div').find(".visible_other").val("");
					}
					
				}		
			);
		
	}

	var forceWindowCloseAfterDialogCloses = function($dialog) {
		$dialog.on("dialogclose", function(event, ui) {
			window.open("#$[next_id];flyto"); //balloonFlyto - annoying to have the balloon open, doesn't let you see the plot
		});
	}
	
	// Place all the selected values on a multiple select inside a multiple array
	var copyMultipleSelectToHiddenInput = function(){
		var selectPrefix = "hidden_";
		
		$(".selectpicker[name^='" + selectPrefix + "']").change(
				function(){
						var valuesSeparated = "";
						
						var hiddenVarName = $(this).attr('name');
						hiddenVarName = hiddenVarName.substring( selectPrefix.length);
						$(this).find('option:selected').each(
							function(){
								valuesSeparated += $(this).val() + SEPARATOR_MULTIPLE_PARAMETERS;
							}	
						);
						valuesSeparated = valuesSeparated.substring(0, valuesSeparated.length - SEPARATOR_MULTIPLE_PARAMETERS.length);
						
						// JQUERY bug, this should work but does not : $("#"+hiddenVarName).val( valuesSeparated );
						$("input[name='" + hiddenVarName + "']").val( valuesSeparated );
				}
		);
	}
		
	var serializeForm = function(formId){
		return $("#"+formId).serialize();
	}
	
	// To be used by the method that saves the data automatically when the user interacts with the form
	// DO NOT REMOVE
	var ajaxTimeout = null; 
	
	var ajaxDataUpdate = function(){
		
		var actively_saved = $("input[id=collect_boolean_actively_saved]").val();
		// Only update automatically when the data has not been correctly saved before
		if( actively_saved == 'false' ){
			// Set a two second timeout so that the data is only sent to the server if the user stops clicking for over one second
			clearTimeout(ajaxTimeout);
			ajaxTimeout = setTimeout(function() {
				var $form = $("#formAll");
				var data = serializeForm("formAll");							
				$.ajax({
					data : data,
					type : $form.attr("method"),
					url : $form.attr("action"),
					dataType : 'json'
				});
			},100);
		}
	};
	
	var enableSelect = function( selectName, enable ){ //#elementsCover
		if( enable == true  ){
			 $(selectName).prop('disabled',false);
		}else{
			 $(selectName).prop('disabled',true);
		}
		$(selectName).selectpicker('refresh');
	}
	
	var toggleDependantSelect = function( parentSelect, nameDependantSelect ){ //#elementsCover
		var elementSelected = false;
		$( parentSelect + " option:selected").each(function () {        
			elementSelected = true;    
		});  

		enableSelect( nameDependantSelect, elementSelected );
	}

	var activateLandUseDivs = function( landUseValue ){
		 
		 $('.tab-pane').hide(); // Hide all land use divs
		 $('#tab_'+landUseValue).show();// Show the div for the actual selected land use
		 
		 if( landUseValue=='noData'){
			 $('#commonDivs').hide();
		 }else{
			 $('#commonDivs').show();
		 }

	}
	
	var fillDataWithJson = function(json) {

		var keys = Object.keys(json);

		for (var indxKey=0; indxKey<keys.length;indxKey++) {
			var key = keys[indxKey];
			var value = json[key];
			console.log("key " + key + "  value " + value );
			// Do this for every key there might be different tryopes of elements with the same key than a hidden input
			if ($("input[name=\'" + key + "\']").length == 1) {
				$("input[name=\'" + key + "\']").val(value);
			} 
			
			if ($("textarea[name=\'" + key + "\']").length == 1) {
				$("textarea[name=\'" + key + "\']").val(value);
			} else if ($("select[name=\'" + key + "\']").length == 1) {
				var values = value.split( SEPARATOR_MULTIPLE_PARAMETERS );
				
				$("select[name=\'" + key + "\']").selectpicker('val',	values);
				$("select[name=\'" + key + "\']").selectpicker('render');
				$("select[name=\'" + key + "\']").selectpicker('refresh');
			}else if( $('#'+key+'_group').length == 1 ){ // button group exists
				var values = value.split( SEPARATOR_MULTIPLE_PARAMETERS );
				for (var i = 0; i < values.length; i++) {
					//$('#'+key+'_group .btn[value='+value+']').button('toggle'); // set the class to "active" on the chosen values
					if( $('#'+key+'_group .btn[value=\''+value+'\']').length == 1){
						var toggleButton = $('#'+key+'_group .btn[value=\''+value+'\']');
						toggleButton.button('toggle');
						if( key == "collect_code_land_use_category" ){
							activateLandUseDivs( toggleButton.val() );
						}
					}
				}
			}else if( $('.landUseTypeSelector .btn[value=\''+value+'\']').length == 1 ){
				var toggleButton = $('.landUseTypeSelector .btn[value=\''+value+'\']');
				toggleButton.button('toggle');				
			}else if ($("select[name=\'hidden_" + key + "\']").length == 1) {
				var values = value.split( SEPARATOR_MULTIPLE_PARAMETERS );
				$("select[name=\'hidden_" + key + "\']").selectpicker('val',	values);
				$("select[name=\'hidden_" + key + "\']").selectpicker('render');
			}

			if( key == "collect_boolean_land_use_subdivision_accuracy" ){
				$('.toggleAccuracySubDivision[value=\''+value+'\']').each( 
						function () {        
							$(this).button('toggle');
						}
				);
			}
			
		}
	}
	
		
	var initializeChangeEventSaver = function(){
		$(".btn").click(function(){
			var groupId = $(this).closest("div .btn-group").attr("id");
			
			var suffixLength =  "_group".length;
			if( groupId && groupId.length > suffixLength ){
				 var value = $(this).val();
				// When we expect data sucha as "0;collect_code_deforestation_reason=burnt"
				 var values = value.split(";");
				
				 var idLength = groupId.length - suffixLength;
				 var hiddenInputId = groupId.substring(0,  idLength );
				 $('#'+hiddenInputId).val( values[0] );// give the hidden input the same value as the button that just was clicked
				 
				 if( $('.'+hiddenInputId+'_dependant').length > 0 ){
					var dependants =$('.'+hiddenInputId+'_dependant:hidden');
					resetDependants(hiddenInputId);
				 }
				 
				// If there is an extra value "collect_code_deforestation_reason=burnt"
				 if( values.length == 2 ){
					 var extraValues = values[1].split("=");
					 $('#'+extraValues[0]).val( extraValues[1] );
				 }
			}
			ajaxDataUpdate();
		});
		
		$('.landUseTypeSelector').find("button").click( function(e){
			var selectedUseType = e.target;
			var value = selectedUseType.value;
			$("input[id=collect_code_land_use_subdivision]").val(value);
			resetDependants('collect_code_land_use_subdivision');
			ajaxDataUpdate();
		});
		
		// SAVING DATA WHEN DATA CHANGES
		// Bind event to Before user leaves page with function parameter e
		// The window onbeforeunload or onunload events do not work in Google Earth
		// OBS! The change event is not fired for the hidden inputs when the value is updated through jQuery's val()
		$('input[name^=collect], select[name^=collect],select[name^=hidden], button[name^=collect]').change(
				function(e){
					ajaxDataUpdate();
				}
		);
		
		$('input:text[name^=collect], textarea[name^=collect]').keyup(
				function(e){
					ajaxDataUpdate(1500);
				}
		);
		
		copyMultipleSelectToHiddenInput();
	}
	
	var interpretJsonSaveResponse = function(json) {
		if (json.type == 'warning') {
			$('#succ_mess').css("color", "yellow").html(json.message);
		} else if (json.type == 'success' && json.valid_data && json.valid_data == 'false' ) {
			
			var message = "";
			
			$.each(json, function(key, value){
				if( key.indexOf("validation_") == 0 ){
					message += value + "<br>";
				}
			});
			
			$('#succ_mess').css("color", "red").html(message);
			
			// Resest the "actively saved" parameter to false so that it is not sent aw true when the user fixes the validation
			$("input[id=collect_boolean_actively_saved]").val('false');
			
			
		} else if (json.type == 'success') {
			$('#succ_mess').css("color", "green").html(json.message);
			forceWindowCloseAfterDialogCloses($("#dialogSuccess"));
		} else if (json.type == 'error'){
			$('#succ_mess').css("color", "red").html(json.message);
		}
		$("#dialogSuccess").dialog("open");
	}

	var checkIfPlacemarkAlreadyFilled = function(formName, chechCount ) {

		data = $(formName + " :input[value]").serialize();

		$.ajax({
			data : data,
			type : "POST",
			url : "$[host]placemarkInfo",
			//url: "http://127.0.0.1:8020/earth/placemarkInfo",
			dataType : 'json',
			timeout : 5000
		}).fail( function(jqXHR, textStatus, errorThrown) {
			
			if( chechCount < 3 ){
				chechCount = chechCount + 1;
				checkIfPlacemarkAlreadyFilled( formName, chechCount );
			}else{
				$('#succ_mess').css("color", "red").html("The Collect Earth server is not running!");
				$("#dialogSuccess").dialog("open");
				initializeChangeEventSaver();
			}
			
		}).done( function(json){
			if( json.placemark_found == 'false'){
				activateLandUseDivs('U100');
			}else{
				if( json.collect_boolean_actively_saved == 'true' && json.collect_text_id != 'testPlacemark'){ // 
					
					$('#succ_mess').css("color", "red").html( "The data for this placemark has already been filled");
					$("#dialogSuccess").dialog( "open" );
					
					if( json.earth_skip_filled && json.earth_skip_filled == 'true'){
						forceWindowCloseAfterDialogCloses($("#dialogSuccess"));
					}
				}
				// Pre-fills the form and after that initilizes the change event listeners for the inputs
				fillDataWithJson(json);
			}
				initializeChangeEventSaver();
			});
	}
	
	var resetDependants = function( inputName){
		// Reset inputs
		$('input.'+inputName+'_dependant:hidden').each( function(){
			$(this).val('');
		});
		
		//Reset buttons
		$(':button.'+inputName+'_dependant').each( function(){
			$(this).removeClass('active');
		});
		
		//Reset selects
		$('select.'+inputName+'_dependant').each( function(){
			$(this).selectpicker('val', -1);
		});
	}
	
	var submitForm = function($form, submitCounter ){
		var $form = $("#formAll");	
		var data = serializeForm("formAll");						
		var request = $.ajax({
					data : data,
					type : $form.attr("method"),
					url : $form.attr("action"),
					dataType : 'json',
					timeout : 5000,
					beforeSend : function() {			
						$.blockUI({ message : 'Sumitting data..' });
					}
				}).done( function(json) {
						interpretJsonSaveResponse(json);
				}).fail( function(jqXHR, textStatus, errorThrown) {	
					if( submitCounter < 3 ){
						submitCounter = submitCounter + 1;
						submitForm( $form, submitCounter );
					}else{
						$('#succ_mess').css("color","red").html("Cannot save the data, the Collect Earth server is not running! ");
						$("#dialogSuccess").dialog("open");
					}
				}).always( function() {
						$.unblockUI();
				});
	}

	$(document)
			.ready(
					function() {

						fillYears();
						
						$(".land_use_category").find("button").not(".no_land_use").click(function(){
							console.log("Activating Land Use  for  " + $(this).val() );
							activateLandUseDivs($(this).val());
						});

						// Declares the Jquery Dialog ( The Bootstrap dialog does not work in Google Earth )
						$("#dialogSuccess").dialog({
							modal : true,
							autoOpen : false,
							buttons : {
								Ok : function() {
									$(this).dialog("close");
								}
							}
						});

						// Mark the selects as "bootstratp-select" enabled 
						$('.selectpicker').selectpicker({size: 5});
						$('.longDataSize').selectpicker({size: 10});

						$("#elements").change(
								function() {
									toggleDependantSelect("#elements",
											'#elementsCover');
								});

						$('.toggleAccuracySubDivision').on(
								'click',
								function(e) {
									var selectedButton = e.target;
									$("input[id=collect_boolean_land_use_subdivision_accuracy]").val(selectedButton.value);
								});

						
						checkIfPlacemarkAlreadyFilled('#formAll', 0);
				
						
						// SAVING DATA WHEN USER SUBMITS
						$('#formAll')
								.submit(
										function(e) {
											
											e.preventDefault();
											
											clearTimeout(ajaxTimeout); // So that the form is not save twice if the user clicks the submit button before the auto-save timeout has started
											
											// Mark this as the "real submit" (as opposed when saving data just because the user closes the window) so we can show the placemark as interpreted
											$("input[id=collect_boolean_actively_saved]").val("true");

											submitForm( $(this), 0 );
										}
									);
						
					});
</script>
<style type="text/css">

	#toolbar {
		padding: 4px;
		display: inline-block;
		margin: 1px;
		width:96%;
	}
	
	body {
		font-family: "Trebuchet MS", "Helvetica", "Arial", "Verdana",
			"sans-serif";
	}
	
	.capsuleCat {
	    border: 1px solid #AED0EA;
	    color: #222222;
	    font-weight: bold;
	    background-color: #e9f3f9;
	}
	
	
	.label-over {
	    background-color: #EEEEEE;
	    border: 1px solid #CCCCCC;
	    display: inline-block;
	    font-size: 12px;
	    font-weight: normal;
	    height: 12px;
	    line-height: 10px;
	    min-width: 16px;
	    padding: 4px 5px;
	    text-align: center;
	    text-shadow: 0 1px 0 #FFFFFF;
	    width: auto;
	    margin-bottom: 5px;
		margin-top: 5px;
		border-top-left-radius: 8px;
		border-top-right-radius: 8px;
		border-bottom-left-radius: 8px;
		border-bottom-right-radius: 8px;
		display : inline-block;
	}
	
	.add-on {
		width: 60px !important;
	}
	
	.input-prepend .add-on, .input-prepend .btn {
	    margin-left: 4px;
	    
	}
	
	label {
		display: inline;
	}
	
	hr {
		margin: 5px;
	}
	
	
	.bootstrap-select:not([class*="span"]) {
	    width: 170px;
	}
	
	.bootstrap-select {
	    width: 170px\9; /*IE8 and below*/
	}
	
	.ui-dialog-titlebar-close {
	    background-image: url(earthFiles/img/close.png) !important;
	    background-position: left top !important;
	}
	
	.btn-primary {
	    background-color: #003dda !important;
	    
	    padding-left: 8px;
	    padding-right: 8px;
	}
	
	.btn-primary.active, .btn-warning.active, .btn-danger.active, .btn-success.active, .btn-info.active, .btn-inverse.active {
	   	color: rgba(255, 255, 255, 0.45) !important;
	   	
	}
	
	.earthDiv{
		width: 340px;
	}
	
	.firstElementToggle{
	    border-bottom-left-radius: 4px !important;
	    border-top-left-radius: 4px !important;
	    margin-left: 0 !important;
	    font-size: 12px;
	}
	
	.lastElementToggle{
	    border-bottom-right-radius: 4px !important;
	    border-top-right-radius: 4px !important;
	    font-size: 12px;
	}
	
	
	table.independentToggle button, .independentToggle button {
		font-size: 12px;
	    border-bottom-left-radius: 4px !important;
	    border-top-left-radius: 4px !important;
	    margin-left: 0 !important;
	    border-bottom-right-radius: 4px !important;
	    border-top-right-radius: 4px !important;
	}
	
	
	.btnCategory{
	   	width: 160px; !important;
	   	margin-right:5px;
	   	margin-bottom:4px;
	   	
	}
	
	table.btnForestType button {
	   	width: 100px; !important;
	   	margin-right:3px;
	   	margin-bottom:4px;
	   	margin-top:4px;
	}
	
	table.btnManufacturingType button {
	   	width: 150px; !important;
	   	margin-right:3px;
	   	margin-bottom:4px;
	   	margin-top:4px;
	}
	
	table.btnTransportType button {
	   	width: 100px; !important;
	   	margin-right:3px;
	   	margin-bottom:4px;
	   	margin-top:4px;
	}
		
	table.btnUnusedType button {
	   	width: 120px; !important;
	   	margin-right:3px;
	   	margin-bottom:4px;
	   	margin-top:4px;
	}
	
	btnUnusedType
	
	div.btnHumanImpact button{
		width: 80px; !important;
	}
	
	div.btnOtherCategory button {
		width: 90px; !important;
		margin-right:3px;
	   	margin-bottom:4px;
	}
	
	div.btnGrasslandCategory button {
		width: 140px; !important;
		margin-right:3px;
	   	margin-bottom:4px;
	}
	
	
	div.btnCroplandCategory button{
		width: 110px; !important;
		margin-right:3px;
	   	margin-bottom:4px;
	}

</style>

</head>

	<div id="dialogSuccess">
		<table><tr><td valign="top">
			<span class="ui-icon ui-icon-circle-check"
				style="float: left; margin: 0 7px 70px 0;"> </span>
		</td><td valign="top">
		<div id="succ_mess">
			
		</div>
			
		</td></table>
		
		
		
	</div>
	
<body>

	<form id="formAll" method="POST" action="$[host]saveData">
	<!--  <form id="formAll" method="POST" action="http://127.0.0.1:8020/earth/saveData"> -->
	<div id="ScrollingDiv" style="overflow :visible;" class="earthDiv">
	<div id="contentDiv"  style="height:600px;width:96%;">
	
		<input type="hidden" id="collect_text_id"
			name="collect_text_id" value="$[id]" />
		<input type="hidden" id="collect_coord_location" 
			name="collect_coord_location" value="$[latitude],$[longitude]" />
		
		<input type="hidden" id="collect_text_plot_file" 
			name="collect_text_plot_file" value="$[plot_file]" />
			
		<input type="hidden" id="collect_code_land_use_category" name="collect_code_land_use_category"
			value="U100" />  <!-- Use the forest land use as default -->
		<input type="hidden" id="collect_boolean_land_use_category_accuracy" 
			name="collect_boolean_land_use_category_accuracy" class="collect_code_land_use_category_dependant"/> 

		<input type="hidden" id="collect_code_land_use_subdivision" 
			name="collect_code_land_use_subdivision" class="collect_code_land_use_category_dependant"/> 
		<input type="hidden" id="collect_boolean_land_use_subdivision_accuracy" 
			name="collect_boolean_land_use_subdivision_accuracy" class="collect_code_land_use_subdivion_dependant collect_code_land_use_category_dependant"/> 
		<input type="hidden" id="collect_code_rs_satellite"
			name="collect_code_rs_satellite"  />
			
			
		<input type="hidden" id="collect_integer_elevation" 
			name="collect_integer_elevation" value="$[elevation]" />
		<input type="hidden" id="collect_real_aspect" 
			name="collect_real_aspect" value="$[aspect]" />
		<input type="hidden" id="collect_real_slope" 
			name="collect_real_slope" value="$[slope]" />
		<input type="hidden" id="collect_text_region" 
			name="collect_text_region" value="$[region]" />	
		<input type="hidden" id="collect_boolean_actively_saved"
			name="collect_boolean_actively_saved" value="false" />


				<div class="earthDiv" style="background-image: url(earthFiles/img/Open-foris-banner2.jpg); height:47px;clear:none;">
				
					<span style="float: right;display:inline;margin-top:5px;" >				
					<img src="earthFiles/img/fao-logo.png" border="0" style="vertical-align:bottom;"/>
					
					
					</span> 
				</div>
				<div class="earthDiv" id="collapsableContents">
					<div id="toolbar" class="capsuleCat ui-corner-all" style="padding:4px;padding-bottom:3px;padding-left:3px;">
							<span style="font-size:11px;padding-top: 4px;">ID: $[id]  -  Elevation: $[elevation]m, Aspect: $[aspect]&deg;, Slope: $[slope]&deg;</span>
					</div>
					<div id="tabsTypeOfTerrain">
	
						<div id="toolbar" class="capsuleCat ui-corner-all" style="position: relative;">
							<h5>Land use categories</h5>
							
							<div style="clear:both;">
							<div class="control-group btn-group" style="float:left;vertical-align: bottom;"   id="collect_code_land_use_category_group">
								<table class=" land_use_category independentToggle" data-toggle="buttons-radio">
									<tr>
										<td>
											<button type="button"
												class="btn btn-primary active btnCategory" title="AGRICULTURE, FORESTRY AND FISHING"
												value="U100">Agriculture/Forestry/Fishing</button>
										</td>
										<td>
											<button type="button"
												class="btn btn-primary btnCategory " title="MANUFACTURING AND ENERGY"
												value="U200">Manufacturing/energy</button>
										</td>
									</tr>
									<tr>
										<td>
											<button type="button"
											class="btn btn-primary btnCategory" title="TRANSPORT, COMMUNICATION NETWORKS, STORAGE, PROTECTIVE WORKS"
											value="U300">Transp./Comm./Storage/Prot</button>
										</td>
										<td>
											<button type="button"
											class="btn btn-primary btnCategory" title="UNUSED AND ABANDONED AREAS"
											value="U400">Unused/Abandoned Areas</button>
										</td>
									</tr>
									<tr>
										<td>
											<button type="button"
											class="btn btn-primary btn-warning  btnCategory"
											value="noData">No Data</button>
										</td>
										<td>
								
											<div class="control-group" style="margin-bottom: 0px !important;">
												<div class="input-prepend btn-group" data-toggle="buttons-radio" id="collect_boolean_land_use_category_accuracy_group">
													<span class="add-on">Accuracy</span>
													<button type="button" style="margin-left:0px"
														class="btn btn-primary no_land_use collect_code_land_use_category_dependant firstElementToggle"
														value="true">YES</button>
													<button type="button"
														class="btn btn-primary no_land_use collect_code_land_use_category_dependant "
														value="false">NO</button>
												</div>
											</div>
						
										</td>
									</tr>									
								</table>
							</div>
							
							</div>
						</div>
						
					</div>
				<div class="tab-content" style="overflow :visible;">
					<div id="tab_U100" class="tab-pane active">
						<div id="toolbar" class="capsuleCat ui-corner-all"
							style="width: 96%">
							
							<h5>Land use sub-division</h5>
								<table class="control-group landUseTypeSelector btn-group independentToggle btnForestType" data-toggle="buttons-radio">
									<tr>
										<td valign="top">
											<table >
												<tr>
													<td colspan="100%"><h6>Agriculture</h6></td>
												</tr>
											
												<tr>
													<td>
														<button type="button"
															class="btn btn-primary"
															value="U111" title="Agriculture (excluding fallow land and kitchen gardens)">Agricultural</button>
													</td>
													<td>
														<button type="button"
															class="btn btn-primary"
															value="U112" title="Fallow land">Fallow land</button>
													</td>
													<td>
														<button type="button"
															class="btn btn-primary"
															value="U113" title="Kitchen gardens">Kitchen gardens</button>
													</td>
												

												</tr>
											</table>
										</td>
									</tr>
									<tr>
										<td rowspan="100%" height="100%" valign="top">

											<table style="border-top: 1px solid rgb(174, 206, 239);padding-left: 2px;">
												<tr>

													<td>
														<button type="button"
															class="btn btn-primary "
															value="U120" title="Forestry">Forestry</button>
													</td>

												
													<td>
														<button type="button"
															class="btn btn-primary"
															value="U130" title="Aquaculture and Fishing">Aquaculture/Fishing</button>
													</td>

												

													<td>
														<button type="button"
															class="btn btn-primary"
															value="U140" title="Mining and Quarrying">Mining/Quarrying</button>
													</td>

												</tr>
												
											</table>


										</td>
									</tr>

								</table>
							
							<div class="control-group" style="margin-bottom: 0px  !important;">
								<div class="input-prepend btn-group" data-toggle="buttons-radio" >
									<span class="add-on"  style="margin-left: 0px !important;">Accuracy</span>
									<button type="button" style="margin-left:0px"
										id="FLUncertaintyTrue" class="btn btn-primary toggleAccuracySubDivision collect_code_land_use_subdivision_dependant collect_code_land_use_category_dependant firstElementToggle"
										value="true">YES</button>
									<button type="button"
										class="btn btn-primary toggleAccuracySubDivision collect_code_land_use_subdivision_dependant collect_code_land_use_category_dependant"
										id="FLUncertainFalse" value="false">NO</button>
								</div>
							</div>
							
						</div>
					
					</div>
					
					<div id="tab_U300" class="tab-pane">

						<div id="toolbar" class="capsuleCat ui-corner-all" >
							
							<h5>Land use sub-division</h5>

								<table class="control-group landUseTypeSelector btn-group independentToggle btnTransportType" data-toggle="buttons-radio">
									<tr>
										<td valign="top">
											<table >
												<tr>
													<td colspan="100%"><h6>TRANSPORT/COMM. NETWORKS/STORAGE/PROTECTIVE WORKS</h6></td>
												</tr>
											
												<tr>
													<td>
														<button type="button"
															class="btn btn-primary"
															value="U311" title="Railways">Railways</button>
													</td>
													<td>
														<button type="button"
															class="btn btn-primary"
															value="U312" title="Roads">Roads</button>
													</td>
													<td>
														<button type="button"
															class="btn btn-primary"
															value="U313" title="Water transport">Water transport</button>
													</td>
												</tr>
												
												<tr>
													<td>
														<button type="button"
															class="btn btn-primary"
															value="U314" title="Air transport">Air transport</button>
													</td>
													<td>
														<button type="button"
															class="btn btn-primary"
															value="U315" title="Transport via pipelines">Pipelines</button>
													</td>
												</tr>
											</table>
										</td>
									</tr>
									<tr>
										<td height="100%" valign="top"  style="border-top: 1px solid rgb(174, 206, 239);padding-left: 2px;">
											<table >
												<tr>
													<td colspan="100%"><h6>SETTLEMENTS</h6></td>
												</tr>
												<tr>
													<td>
														<button type="button"
															class="btn btn-primary"
															value="U370" title="Residential">Residential</button>
													</td>
													<td>
														<button type="button"
															class="btn btn-primary"
															value="U330" title="Construction">Construction</button>
													</td>
													<td>
														<button type="button"
															class="btn btn-primary"
															value="U350" title="Community Services">Comm. Services</button>
													</td>
												

												</tr>
											</table>
										</td>
									</tr>
									<tr>
										<td height="100%" valign="top"  style="border-top: 1px solid rgb(174, 206, 239);padding-left: 2px;">
											<table >
												<tr>
													<td colspan="100%"><h6>OTHER</h6></td>
												</tr>
												<tr>
													<td>
														<button type="button"
															class="btn btn-primary"
															value="U316" title="Telecommunication">Telecomm.</button>
													</td>
													<td>
														<button type="button"
															class="btn btn-primary"
															value="U317" title="Storage">Storage</button>
													</td>
													<td>
														<button type="button"
															class="btn btn-primary"
															value="U318" title="Water transport">Protection works</button>
													</td>
												

												</tr>
											</table>
										</td>
									</tr>
									<tr>
										<td height="100%" valign="top"  style="border-top: 1px solid rgb(174, 206, 239);padding-left: 2px;">

											<table >
												<tr>
													<td colspan="100%"><h6>WATER AND WASTE TREATMENT</h6></td>
												</tr>
											
												<tr>
													<td>
														<button type="button"
															class="btn btn-primary" style="width:180px; !important;"
															value="U321" title="Water supply and treatment">Water supply and treatment</button>
													</td>
													<td>
														<button type="button"
															class="btn btn-primary"
															value="U322" title="Waste treatment">Waste treatment</button>
													</td>
												</tr>
												
												<tr>
													<td colspan="100%"><h6>RECREATION, LEISURE, SPORT</h6></td>
												</tr>
											
												<tr>
													<td>
														<button type="button"
															class="btn btn-primary" style="width:180px; !important;"
															value="U361" title="Amenities, museums, leisure">Amenities/Museums/Leisure</button>
													</td>
													<td>
														<button type="button"
															class="btn btn-primary"
															value="U362" title="Waste treatment">Sport</button>
													</td>
												</tr>
												<tr>
													<td>
														<button type="button"
															class="btn btn-primary"
															value="U363" title="Holiday camps">Holiday camps</button>
													</td>
												</tr>
												
												
											</table>
										</td>
									</tr>

								</table>
							<div class="control-group" style="margin-bottom: 0px  !important;">
								<div class="input-prepend btn-group" data-toggle="buttons-radio" >
									<span class="add-on"  style="margin-left: 0px !important;">Accuracy</span>
									<button type="button" style="margin-left:0px"
										id="FLUncertaintyTrue" class="btn btn-primary toggleAccuracySubDivision collect_code_land_use_subdivision_dependant collect_code_land_use_category_dependant firstElementToggle"
										value="true">YES</button>
									<button type="button"
										class="btn btn-primary toggleAccuracySubDivision collect_code_land_use_subdivision_dependant collect_code_land_use_category_dependant"
										id="FLUncertainFalse" value="false">NO</button>
								</div>
							</div>
						</div>

					</div>
					<div id="tab_U200" class="tab-pane">

						<div id="toolbar" class="capsuleCat ui-corner-all">
							
							<h5>Land use sub-division</h5>
							<table class="control-group landUseTypeSelector btn-group independentToggle btnManufacturingType" data-toggle="buttons-radio">
									<tr>
										<td valign="top">
											<table >
												<tr>
													<td colspan="100%"><h6>Industry and Manufacturing</h6></td>
												</tr>
											
												<tr>
													<td>
														<button type="button"
															class="btn btn-primary"
															value="U221" title="Manufacturing of food, beverages and tobacco products">Food/beverages/tobacco</button>
													</td>
													<td>
														<button type="button"
															class="btn btn-primary"
															value="U222" title="Manufacturing of textile products">Textile products</button>
													</td>
												</tr>
												<tr>
													<td>
														<button type="button"
															class="btn btn-primary"
															value="U223" title="Kitchen gardens">Coal/oil/metal processing</button>
													</td>
													
													<td>
														<button type="button"
															class="btn btn-primary"
															value="U224" title="Production of non-metal mineral goods">Non-metal mineral goods</button>
													</td>
													
												</tr>
												<tr>	
													<td>
														<button type="button"
															class="btn btn-primary"
															value="U226" title="Machinery and equipment">Machinery/Equipment</button>
													</td>

													<td>
														<button type="button"
															class="btn btn-primary"
															value="U227" title="Wood based products">Wood based products</button>
													</td>
												</tr>
												<tr>
													<td colspan="2">
														<button type="button" style ="width: 300px; !important;"
															class="btn btn-primary"
															value="U225" title="Chemical and allied industries and manufacturing">Chemical and allied industries and manufacturing</button>
													</td>
												</tr>
											</table>
										</td>
										</tr>
										<tr>
										<td rowspan="100%" height="100%" valign="top">

											<table style="border-top: 1px solid rgb(174, 206, 239);padding-left: 2px;">
												<tr>

													<td>
														<button type="button"
															class="btn btn-primary "
															value="U210" title="Energy Production">Energy Production</button>
													</td>

												</tr>
								
											</table>


										</td>
									</tr>

								</table>
							<div class="control-group" style="margin-bottom: 0px  !important;">
								<div class="input-prepend btn-group" data-toggle="buttons-radio" >
									<span class="add-on"  style="margin-left: 0px !important;">Accuracy</span>
									<button type="button" style="margin-left:0px"
										id="FLUncertaintyTrue" class="btn btn-primary toggleAccuracySubDivision collect_code_land_use_subdivision_dependant collect_code_land_use_category_dependant firstElementToggle"
										value="true">YES</button>
									<button type="button"
										class="btn btn-primary toggleAccuracySubDivision collect_code_land_use_subdivision_dependant collect_code_land_use_category_dependant"
										id="FLUncertainFalse" value="false">NO</button>
								</div>
							</div>
						</div>

					</div>

					<div id="tab_U400" class="tab-pane">
						
							
							<div id="toolbar" class="capsuleCat ui-corner-all">
							
							<h5>Land use sub-division</h5>
							
							<table class="control-group landUseTypeSelector btn-group independentToggle btnUnusedType" data-toggle="buttons-radio">
									<tr>
										<td valign="top">
											<table >
												<tr>
													<td colspan="100%"><h6>UNUSED AND ABANDONED AREAS</h6></td>
												</tr>
											
												<tr>
													<td>
														<button type="button"
															class="btn btn-primary"
															value="U410" title="Abandoned areas">Abandoned areas</button>
													</td>
													<td>
														<button type="button"
															class="btn btn-primary"
															value="U420" title="Semi-natural and natural areas not in use">Not in use</button>
													</td>
												</tr>
											</table>
										</td>
									</tr>
								</table>
									<div class="control-group" style="margin-bottom: 0px  !important;">
								<div class="input-prepend btn-group" data-toggle="buttons-radio" >
									<span class="add-on"  style="margin-left: 0px !important;">Accuracy</span>
									<button type="button" style="margin-left:0px"
										id="FLUncertaintyTrue" class="btn btn-primary toggleAccuracySubDivision collect_code_land_use_subdivision_dependant collect_code_land_use_category_dependant firstElementToggle"
										value="true">YES</button>
									<button type="button"
										class="btn btn-primary toggleAccuracySubDivision collect_code_land_use_subdivision_dependant collect_code_land_use_category_dependant"
										id="FLUncertainFalse" value="false">NO</button>
								</div>
							</div>
							</div>

						</div>

					<div id="tab_noData" class="tab-pane">
						<div id="toolbar" class="capsuleCat ui-corner-all" style="width:96%">
								<h5>No data</h5>
								
								<div class="control-group">
									No data available for this plot.
								</div>
									<h5>Land use sub-division</h5>
								<div class="control-group " >
									
									<div class="btn-group landUseTypeSelector " data-toggle="buttons-radio" id="settlement">
									 	<button type="button" class="btn btn-primary collect_code_land_use_category_dependant"  value="sea">Sea</button>
									    <button type="button" class="btn btn-primary collect_code_land_use_category_dependant" value="clouds">Clouds</button>
									    <button type="button" class="btn btn-primary collect_code_land_use_category_dependant" value="other_reason">Other reason</button>
								    </div>

								</div>
						</div>
					</div>					
				</div>

					<div id="commonDivs">
						<div id="toolbar" class="capsuleCat ui-corner-all">
							<h5>Site description</h5>
							
							<div class="label-over">Directions</div>
							<div class="control-group">
									<textarea rows="3"  id="collect_text_site_directions" name="collect_text_site_directions"></textarea>
							</div>
							<div class="label-over">Elements</div>
								<div class="control-group">
									<div class="input-prepend">
										<span class="add-on">Road</span> <select
											class="selectpicker  show-tick show-menu-arrow "
											id="collect_entity_topography[road].code_coverage" name="collect_entity_topography[road].code_coverage">
											<option value="na">Not Applicable</option>
											<option  value="0-10">0-10%</option>
											<option value="10-30">10-30%</option>
											<option value="30-60">30-60%</option>
											<option value="60-100">60-100%</option>
										</select>
		
									</div>
									<div class="input-prepend">
										<span class="add-on">River</span> <select
											class="selectpicker  show-tick show-menu-arrow "
											id="collect_entity_topography[river].code_coverage" name="collect_entity_topography[river].code_coverage">
											<option value="na">Not Applicable</option>
											<option  value="0-10">0-10%</option>
											<option value="10-30">10-30%</option>
											<option value="30-60">30-60%</option>
											<option value="60-100">60-100%</option>
										</select>
		
									</div>
									<div class="input-prepend">
										<span class="add-on">Lake</span> <select
											class="selectpicker  show-tick show-menu-arrow "
											id="collect_entity_topography[lake].code_coverage" name="collect_entity_topography[lake].code_coverage">
											<option value="na">Not Applicable</option>
											<option  value="0-10">0-10%</option>
											<option value="10-30">10-30%</option>
											<option value="30-60">30-60%</option>
											<option value="60-100">60-100%</option>
										</select>
		
									</div>
									<div class="input-prepend">
										<span class="add-on">House</span> <select
											class="selectpicker  show-tick show-menu-arrow "
											id="collect_entity_topography[house].code_coverage" name="collect_entity_topography[house].code_coverage"
											>
											<option value="na">Not Applicable</option>
											<option  value="0-10">0-10%</option>
											<option value="10-30">10-30%</option>
											<option value="30-60">30-60%</option>
											<option value="60-100">60-100%</option>
										</select>
		
									</div>
									<div class="input-prepend" id="trees_element">
										<span class="add-on">Trees</span> <select
											class="selectpicker  show-tick show-menu-arrow "
											id="collect_entity_topography[trees].code_coverage" name="collect_entity_topography[trees].code_coverage"
											>
											<option value="na">Not Applicable</option>
											<option  value="0-10">0-10%</option>
											<option value="10-30">10-30%</option>
											<option value="30-60">30-60%</option>
											<option value="60-100">60-100%</option>
										</select>
		
									</div>
									
									<div class="input-prepend" id="garden_element">
										<span class="add-on">Garden</span> <select
											class="selectpicker  show-tick show-menu-arrow "
											id="collect_entity_topography[garden].code_coverage" name="collect_entity_topography[garden].code_coverage"
											>
											<option value="na">Not Applicable</option>
											<option  value="0-10">0-10%</option>
											<option value="10-30">10-30%</option>
											<option value="30-60">30-60%</option>
											<option value="60-100">60-100%</option>
										</select>
		
									</div>
									
									<div class="input-prepend">
										<span class="add-on">Other</span> <select
											class="selectpicker  show-tick show-menu-arrow "
											id="collect_entity_topography[other].code_coverage" name="collect_entity_topography[other].code_coverage"
											>
											<option value="na">Not Applicable</option>
											<option  value="0-10">0-10%</option>
											<option value="10-30">10-30%</option>
											<option value="30-60">30-60%</option>
											<option value="60-100">60-100%</option>
										</select>
		
									</div>

								</div>
							</div>
							
							

			
						<div id="toolbar" class="capsuleCat ui-corner-all">
			
							<h5>RS Data</h5>
				
							<div class="label-over">Satellite</div>
									<div class="control-group">
								    <div class="btn-group" data-toggle="buttons-radio" id="collect_code_rs_satellite_group">
									    <button type="button" class="btn btn-primary" value="rapidEye">RapidEye</button>
									    <button type="button" class="btn btn-primary" value="landsat">Landsat</button>
									    <button type="button" class="btn btn-primary" value="digitalGlobe" title="">DigitalGl.</button>
									    <button type="button" class="btn btn-primary" value="spot">Spot</button>
									    <button type="button" class="btn btn-primary" value="other_sat">Other</button>
								    </div>
								    
							</div>
							<div class="label-over">Date</div>
								<div class="control-group">
									 <input type="text" id="collect_date_rs_date" name="collect_date_rs_date" placeholder="month/day/year">
								</div>
						</div>
					</div>
				

		<div class="earthDiv">
					<button type="submit" class="btn btn-success" style="margin-left:25%;margin-right:25%;margin-top:3px;">SUBMIT &amp; VALIDATE</button>
				</div>
			</div>
		</div>
		</div>
	</form>
	<iframe style="display: none" src="http://127.0.0.1:$[local_port]/earth/openAuxiliaryWindows?latLongCoordinates=$[latitude],$[longitude]" height="0" width="0"></iframe>
</body>
</html>
